# 真实数据总结（基于当前 PostgreSQL 入库数据）

## 数据概览
- 数据来源：`backend/data` 下 Excel 全量导入，已写入 PostgreSQL（连接串见 `backend/.env`），共 77 份文件（`ingest_files`）。
- 实际读数：`sensor_readings` 中 `is_simulated=false` 计 1,997,436 条；模拟数据另有 24,226 条可忽略。
- 设施/区段：6 个监测区段，其中真实数据集中在 2 个：发电引水洞、马圈沟主断面。
- 采样频率：发电引水洞各传感器为 60 分钟；马圈沟雷达流量计为 5 分钟；人工比测为单点。

## 数据覆盖（按区段）
| 区段 | 读数 | 时间范围 | 说明 |
| --- | --- | --- | --- |
| 发电引水洞 | 1,950,208 | 2022-09-02 → 2025-10-11 13:00 | 10 类传感器，小时级连续 |
| 马圈沟主断面 | 47,228 | 2025-08-29 → 2025-10-31 13:20 | 雷达流量计 5 分钟 + 1 次人工比测 |
| 其他水文站（板房沟/红雁池/乌拉泊） | 8,068×3（模拟） | 2025-11-25 → 2025-12-02 | 当前为模拟，可在汇报中说明 |

## 数据覆盖（按传感器类型，真实数据）
| 类型 | 传感器数 | 指标数 | 读数 | 时间范围 | 典型频率 |
| --- | --- | --- | --- | --- | --- |
| 钢板计 | 32 | 128 | 4,050,804 | 2022-09-02 → 2025-10-11 | 60 分钟 |
| 钢筋应力计 | 11 | 44 | 1,306,944 | 2022-09-02 → 2025-10-11 | 60 分钟 |
| 渗压计 | 11 | 33 | 709,659 | 2022-10-09 → 2025-10-11 | 60 分钟 |
| 四点式变位计 | 8 | 16 | 217,724 | 2025-01-01 → 2025-10-11 | 60 分钟 |
| 测缝计 | 6 | 12 | 163,304 | 2025-01-01 → 2025-10-11 | 60 分钟 |
| 锚杆应力计 | 2 | 8 | 217,728 | 2025-01-01 → 2025-10-11 | 60 分钟 |
| 无应力计 | 2 | 8 | 217,728 | 2025-01-01 → 2025-10-11 | 60 分钟 |
| 温度计 | 2 | 6 | 81,648 | 2025-01-01 → 2025-10-11 | 60 分钟 |
| 二点式变位计 | 2 | 4 | 54,424 | 2025-01-01 → 2025-10-11 | 60 分钟 |
| 电测水位计 | 1 | 3 | 61,236 | 2025-01-01 → 2025-10-11 | 60 分钟 |
| 雷达流量计 | 1 | 5 | 236,135 | 2025-08-29 → 2025-10-31 | 5 分钟 |
| 人工测量 | 1 | 1 | 1 | 2025-09-30 14:35 | 单点 |

## 指标定义（真实数据使用）
| 类型 | metric_key | 名称 | 单位 |
| --- | --- | --- | --- |
| 钢板计 | resistance_ratio / resistance_sum | 电阻比 / 电阻和 | — |
| 钢板计 | strain | 应变 | 10^-6 |
| 钢板计 | temperature | 温度 | ℃ |
| 钢筋应力计 | resistance_ratio / resistance_sum | 电阻比 / 电阻和 | — |
| 钢筋应力计 | stress | 应力 | MPa |
| 钢筋应力计 | temperature | 温度 | ℃ |
| 渗压计 | pore_pressure | 孔隙水压 | kPa |
| 渗压计 | freq_modulus | 频率模数 | KHz^2 |
| 渗压计 | temperature | 温度 | ℃ |
| 四点式/二点式变位计 | displacement | 位移 | mm |
| 四点式/二点式变位计 | resistance_ratio | 电阻比 | — |
| 测缝计 | displacement | 位移 | mm |
| 测缝计 | resistance_ratio | 电阻比 | — |
| 锚杆应力计 | stress | 应力 | MPa |
| 锚杆应力计 | temperature | 温度 | ℃ |
| 锚杆应力计 | resistance_ratio / temperature_resistance | 电阻比 / 温度电阻 | — |
| 无应力计 | strain | 应变 | 10^-6 |
| 无应力计 | temperature | 温度 | ℃ |
| 无应力计 | resistance_ratio / temperature_resistance | 电阻比 / 温度电阻 | — |
| 温度计 | temperature / temperature_measured | 温度 | ℃ |
| 温度计 | resistance | 电阻 | Ω |
| 电测水位计 | water_level | 水位 | m |
| 电测水位计 | temperature | 温度 | ℃ |
| 电测水位计 | freq_modulus | 频率模数 | KHz^2 |
| 雷达流量计 | water_level | 水位 | m |
| 雷达流量计 | velocity | 流速 | m/s |
| 雷达流量计 | flow_rate | 瞬时流量 | m³/s |
| 雷达流量计 | surface_elevation | 水面高程 | m |
| 雷达流量计 | daily_flow_rate | 日均流量 | m³ |
| 人工测量 | manual_flow_rate | 人工比测流量 | m³/s |

## 样例记录（每类取 3 条，真实数据）
| 类型 | 点位 | 时间 | 值 | 单位 |
| --- | --- | --- | --- | --- |
| 钢板计 | GBcg-27 | 2022-09-02 00:00 | 78.47 | — |
| 钢板计 | GBcg-27 | 2022-09-02 00:00 | 24.402 | ℃ |
| 钢板计 | GBcg-27 | 2022-09-02 00:00 | 10282 | — |
| 钢筋应力计 | Rcg-5…右侧 | 2022-09-02 00:00 | 32.9461 | ℃ |
| 钢筋应力计 | Rcg-5…右侧 | 2022-09-02 00:00 | 81.82 | — |
| 钢筋应力计 | Rcg-5…右侧 | 2022-09-02 00:00 | 10046 | — |
| 渗压计 | Pcg-2…1837 | 2022-10-09 00:00 | 22.4 | ℃ |
| 渗压计 | Pcg-2…1837 | 2022-10-09 00:00 | 3741.3 | KHz^2 |
| 渗压计 | Pcg-1…1837 | 2022-10-09 00:00 | 3861.4 | KHz^2 |
| 四点式变位计 | M4f-2-2 | 2025-01-01 00:00 | 5.7731434 | mm |
| 四点式变位计 | M4f-2-2 | 2025-01-01 00:00 | 0.4289 | — |
| 四点式变位计 | M4f-1-2 | 2025-01-01 00:00 | 0.4492 | — |
| 测缝计 | Jf-2 | 2025-01-01 00:00 | 0.5338 | — |
| 测缝计 | Jf-2 | 2025-01-01 00:00 | -0.1007845 | mm |
| 测缝计 | Jf-6 | 2025-01-01 00:00 | 0.4732 | — |
| 锚杆应力计 | ASf-2…闸井段基础 | 2025-01-01 00:00 | 9909 | — |
| 锚杆应力计 | ASf-2…闸井段基础 | 2025-01-01 00:00 | 78.75 | — |
| 锚杆应力计 | ASf-2…闸井段基础 | 2025-01-01 00:00 | -119.62623 | MPa |
| 无应力计 | Nf-1…闸井底板 | 2025-01-01 00:00 | -225.92826 | 10^-6 |
| 无应力计 | Nf-1…闸井底板 | 2025-01-01 00:00 | 9.3781 | ℃ |
| 无应力计 | Nf-2…闸井底板 | 2025-01-01 00:00 | 10175 | — |
| 温度计 | Tf-1…1893.0m | 2025-01-01 00:00 | 0.10 | ℃ |
| 温度计 | Tf-2…1893.0m | 2025-01-01 00:00 | -1.30 | ℃ |
| 温度计 | Tf-1…1893.0m | 2025-01-01 00:00 | 46.62 | Ω |
| 二点式变位计 | M2f-1-2 | 2025-01-01 00:00 | 2.8697919 | mm |
| 二点式变位计 | M2f-1-2 | 2025-01-01 00:00 | 0.3449 | — |
| 二点式变位计 | M2f-1-1 | 2025-01-01 00:00 | 0.3449 | — |
| 电测水位计 | Df-1…闸井边墩 | 2025-01-01 00:00 | 1887.9671588 | m |
| 电测水位计 | Df-1…闸井边墩 | 2025-01-01 00:00 | 2.2937678 | ℃ |
| 电测水位计 | Df-1…闸井边墩 | 2025-01-01 00:00 | 4172.0513536 | KHz^2 |
| 雷达流量计 | MQG_RADAR | 2025-08-29 00:00 | 114495.1688 | — |
| 雷达流量计 | MQG_RADAR | 2025-08-30 00:00 | 113768.3051 | — |
| 雷达流量计 | MQG_RADAR | 2025-08-31 00:00 | 111176.4281 | — |
| 人工测量 | MQG_MANUAL | 2025-09-30 14:35 | 0.651 | m³/s |

> 说明：点位名称中包含原始埋设桩号/安装高程等，仍处于“原样保留”状态。

## 数据模型与字段说明（简要）
- monitoring_facilities：监测设施（例如“MMK 发电引水洞”、“马圈沟水文监测设施”）。字段：`code`、`name`、`facility_type`、`location`。
- monitoring_sections：设施下的区段（e.g. SEC-1=发电引水洞，MQG_MAIN=马圈沟主断面）。字段：`code`、`name`、`section_type`、`chainage`、`is_simulated`。
- sensor_types：传感器类型定义（13 种）。字段：`code`、`name`、`unit`、`prefix_pattern`、`description`、`is_simulated`。
- sensors：具体传感器实例，关联区段/类型/桩号/安装信息。关键字段：`point_code`、`factory_code`、`install_chainage_raw`、`install_elevation`、`install_date`、`install_location_desc`、`instrument_model`、`instrument_manufacturer`、`reading_device`、`status`、`location`（Point）和 `is_simulated`。
- sensor_metrics：传感器下的测项/单位/告警阈值。字段：`metric_key`、`name_cn`、`unit`、`data_type`、`warn_low`、`warn_high`、`is_simulated`。
- sensor_readings：读数表（主数据）。字段：`reading_time`（UTC 时间戳）、`value_num`/`value_text`、`unit`、`raw_values`（原始列 JSON）、`quality_flag`、`remark`、`source_file_id`、`is_simulated`。唯一约束 `(metric_id, reading_time, source_file_id)`。
- ingest_files：导入文件追踪与去重。字段：`path`、`sheet`、`checksum`、`file_mtime`、`rows_imported`、`status`、`message`、`is_simulated`。
- hydrological_stations：水文站信息（马圈沟等），带断面几何/坐标；传感器可挂在该表。
- chainage_coordinates：桩号→坐标/高程映射，供传感器定位。

## 解析/清洗提示
- Excel 表头保留了厂商信息，点位名称较长；若需对外展示，可在 `sensors` 内新增标准化名称。
- 多数字段同时含“电阻比/电阻和/温度”同一时间戳，已拆成多 metric；`raw_values` 中保留原始列便于追溯。
- 时间清洗：导入已过滤 1990 年前值，避免文件头部埋设日期干扰；时间序列连续性可直接按 `reading_time` 排序。

## 后续可加内容（如需）
1) 生成各类型时间序列完整性/缺测率统计；2) 点位重命名与坐标补全；3) 重要指标阈值配置告警；4) 导出图表（PNG/CSV）用于汇报。 
